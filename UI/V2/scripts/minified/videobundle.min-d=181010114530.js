var SEB;!function(a){var b;!function(a){var b=function(){function a(a){this.requestUrl="/WebAPI/media",this.debug=!1,this.requestXhr=null,this.requestInProgress=!1,this.LanguageBranch="",this.yearNavigationPosition=-1,this.requestObj={PageId:"",SelectedYear:0,SelectedFeed:0,SelectedPageSize:0,SelectedOffset:0,LanguageBranch:""},this.selectors={loadmorebtn:".showmore a:eq(0)",tabheaders:".tabs-list > li a",contentlist:"ul.content-list",yearlinks:".yearlinklist a"};var b=this;b.MainBase=a,b.LanguageBranch=$("html").attr("lang"),b.requestObj.SelectedPageSize=parseInt($("#DefaultPageSize").val(),10),b.requestObj.PageId=$("#PageId").val(),b.requestObj.LanguageBranch=b.LanguageBranch,b.$doc=$(document),b.yearNavigation=$("#yearnavigation"),b.yearNavigationSelect=$(".selectlinklist"),b.LoadMore=new KWD.Layout.LayoutLoadMore(b.MainBase),b.addEvents()}return a.prototype.cssToNumber=function(a){var b=a.replace("px","");return parseInt(b,10)},a.prototype.addEvents=function(){var a=this;$(a.yearNavigationSelect.bind("change",function(b){b.preventDefault(),a.onYearSelectClick(this.value)})),$(a.selectors.loadmorebtn).bind("click",$.proxy(a.onLoadMoreBtnClick,a)),$(a.selectors.yearlinks).bind("click",$.proxy(a.onYearLinkClick,a)),$(a.selectors.tabheaders).bind("click",$.proxy(a.onTabClick,a)),$(window).bind("scroll",$.proxy(a.onWindowScroll,a)),$(window).bind("touchmove",$.proxy(a.onWindowScroll,a)),a.debug&&$(a.selectors.tabheaders).eq(1).trigger("click")},a.prototype.onWindowScroll=function(a){var b=this;b.$doc.scrollTop();b.yearNavigation.length>0&&-1===b.yearNavigationPosition&&(b.yearNavigationPosition=b.yearNavigation.offset().top)},a.prototype.onTabClick=function(a){a.preventDefault();var b=this,c=$(a.currentTarget),d=c.attr("href");b.requestInProgress===!1&&(b.requestObj.SelectedYear=0,b.requestObj.SelectedOffset=-1,-1===d.indexOf("?")&&(b.requestObj.SelectedFeed=0),c.parent().siblings().removeClass("current").end().addClass("current"),b.onYearLinkClick(a))},a.prototype.onYearSelectClick=function(a){var b=this,c=a,d=JSON.stringify(b.requestObj);b.requestInProgress===!1&&(b.requestObj.SelectedOffset=-1,b.updateRequestObj(c),d!==JSON.stringify(b.requestObj)&&$(b.selectors.contentlist).empty(),b.requestData($(b.selectors.contentlist).eq(0)))},a.prototype.onYearLinkClick=function(a){a.preventDefault();var b=this,c=$(a.currentTarget),d=c.attr("href"),e=JSON.stringify(b.requestObj);b.requestInProgress===!1&&(b.requestObj.SelectedOffset=-1,b.updateRequestObj(d),e!==JSON.stringify(b.requestObj)&&$(b.selectors.contentlist).empty(),b.requestData($(b.selectors.contentlist).eq(0)))},a.prototype.onLoadMoreBtnClick=function(a){a.preventDefault();var b=this,c=$(a.currentTarget),d=c.attr("href");b.requestInProgress===!1&&(b.updateRequestObj(d),b.requestData($(b.selectors.contentlist).eq(0)))},a.prototype.requestData=function(a){var b=this;b.requestInProgress===!1&&(b.requestInProgress=!0,b.requestXhr=$.ajax({url:b.requestUrl,type:"POST",data:b.requestObj,success:$.proxy(b.onGetData,b,a)}))},a.prototype.updateRequestObj=function(a){var b=this;if(-1!==a.indexOf("Year")||-1!==a.indexOf("Feed"))b.requestObj.SelectedOffset=0,-1!==a.indexOf("Year")&&(b.requestObj.SelectedYear=parseInt(b.MainBase.Utilities.valueOfQueryString(a,"Year"),10)),-1!==a.indexOf("Feed")&&(b.requestObj.SelectedFeed=parseInt(b.MainBase.Utilities.valueOfQueryString(a,"Feed"),10));else{var c=$(b.selectors.contentlist).children().filter(":not(.showmore)").length;b.requestObj.SelectedOffset=-1!==b.requestObj.SelectedOffset?c:0}},a.prototype.onGetData=function(a,b){var c=this;c.requestInProgress=!1,b&&c.expandList(a,b)},a.prototype.expandList=function(a,b){var c=this,d=a.clone(!0),e=b.Items.length,f=c.requestObj.SelectedOffset,g=f+e,h=$(".templates").find('[data-template-type="item"]');0!==e?($(b.Items).each(function(a,b){var e=b.Properties[0].PropertyValue,f=$();if("string"==typeof e&&0!==e.length&&(f=h.filter("."+e).eq(0)),0===f.length&&(f=h.eq(0)),0!==f.length){var g=c.LoadMore.populateTemplate(f,b);d.append(g)}}),a.replaceWith(d),window.picturefill(),g>=b.TotalNumberOfItems?$(c.selectors.loadmorebtn).hide():$(c.selectors.loadmorebtn).show()):$(c.selectors.loadmorebtn).hide()},a}();a.MediaPageBase=b}(b=a.Layout||(a.Layout={}))}(SEB||(SEB={}));var SEB;!function(a){var b;!function(a){var b=function(){function a(a){var b=this;b.MainBase=a,b.VideoContainers=$("div.videoblockv2"),0!==b.VideoContainers.length&&(b.MainBase.Layout.EventHelper.addToEvent("resize",$.proxy(b.onResize,b)),b.MainBase.Layout.EventHelper.addToEvent("orientationchange",$.proxy(b.onResize,b))),b.Init()}return a.prototype.Init=function(){var a=this;0!==a.VideoContainers.length&&a.VideoContainers.each(function(b,c){var d=$(c),e=d.find("iframe"),f=0!==e.length?e.attr("src"):"";0!==f.length?f.indexOf("youtube")>-1?a.CheckAndSetWidthYoutube(d.find("div.videoWrapper:eq(0)")):a.CheckAndSetWidthIframe(d.find("div.videoWrapper:eq(0)")):a.CheckWidthQBrick(d.find("div.videoWrapper:eq(0)")),a.InitiateCoverImage(d)})},a.prototype.onResize=function(){var a=this;a.Init()},a.prototype.InitiateCoverImage=function(a){var b=this;a.on("click touchend","img",$.proxy(b.onCoverImageClick,b))},a.prototype.onCoverImageClick=function(a){var b=this,c=$(a.target),d=c.parents("div:eq(0)"),e=d.find("iframe:eq(0)");if(d.hasClass("youtube")){b.Init();var f=e.attr("src"),g="autoplay=1";f=b.hasQueryString(f)===!0?f+"&"+g:f+"?"+g,c.css({"z-index":"5",visibility:"hidden"}),e.css({opacity:"1"}).attr("src",f)}},a.prototype.SetWmode=function(a){var b=this,c=a.find("iframe:eq(0)"),d="wmode=transparent";if(c.length>0){var e=c.attr("src");e+=b.hasQueryString(e)===!0?"&"+d:"?"+d,c.attr("src",e)}},a.prototype.hasQueryString=function(a){return-1!==a.indexOf("?")},a.prototype.CheckAndSetWidthYoutube=function(a){var b=this;b.CheckAndSetWidthIframe(a),a.addClass("youtube")},a.prototype.CheckAndSetWidthIframe=function(a){var b=a.width(),c=a.find("iframe:eq(0)"),d=parseInt(c.attr("width"),10),e=parseInt(c.attr("height"),10),f=a.parents(".inpagenavigationblockv2"),g=0;if(b>0&&0===f.length&&$.isNumeric(d)===!0&&$.isNumeric(e)===!0){g=e/d;var h="Video"+Math.floor(100*Math.random())+(new Date).valueOf(),i=g*b;c.attr("width",b).attr("height",i).attr("id",h)}},a.prototype.CheckWidthQBrick=function(a){var b=a.width(),c=a.find("> div:eq(0)"),d=parseInt(c.attr("data-qbrick-width"),10),e=parseInt(c.attr("data-qbrick-height"),10),f=0;if(a.addClass("qbrick"),$.isNumeric(d)===!0&&$.isNumeric(e)===!0&&d>b){f=e/d;var g="Video"+Math.floor(100*Math.random())+(new Date).valueOf(),h=f*b;c.attr("data-qbrick-width",b).attr("data-qbrick-height",h).attr("id",g)}},a.prototype.SetWidthQBrich=function(a){var b=this,c=$(a);if(0!==c.length){var d=c.find("object, embed, video");0!==d.length&&(d.css({width:c.attr("data-qbrick-width")+"px",height:c.attr("data-qbrick-height")+"px"}),window.clearInterval(b.interval))}else window.clearInterval(b.interval)},a}();a.VideoBase=b}(b=a.Layout||(a.Layout={}))}(SEB||(SEB={}));